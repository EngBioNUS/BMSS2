

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4. A Priori Identifiability Analysis &mdash; BMSS2 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="3. Making a Model Selection Workflow" href="_Example_3nb.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> BMSS2
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="modules.html">BMSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html#working-with-sbml">Working with SBML</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html#examples">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="_Example_1nb.html">1. Using the Database and Config Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="_Example_2nb.html">2. Simulate New Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="_Example_3nb.html">3. Making a Model Selection Workflow</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4. A Priori Identifiability Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#A-Priori-Identifiability-Analysis">A Priori Identifiability Analysis</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BMSS2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">BMSS</a> &raquo;</li>
        
          <li><a href="examples.html">Examples</a> &raquo;</li>
        
      <li>4. A Priori Identifiability Analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/_Example_4nb.nblink.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="4.-A-Priori-Identifiability-Analysis">
<h1>4. A Priori Identifiability Analysis<a class="headerlink" href="#4.-A-Priori-Identifiability-Analysis" title="Permalink to this headline">¶</a></h1>
<p>In this example, we show you how to a NOT Gate system with BMSS2.</p>
<div class="section" id="A-Priori-Identifiability-Analysis">
<h2>A Priori Identifiability Analysis<a class="headerlink" href="#A-Priori-Identifiability-Analysis" title="Permalink to this headline">¶</a></h2>
<p>We want to know if our candidate models will be fully identifiable based on the states measured. This can achieved using the strike-GOLDD algorithm.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span>             <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span>            <span class="k">as</span> <span class="nn">pd</span>


<span class="kn">import</span> <span class="nn">BMSS.models.model_handler</span>    <span class="k">as</span> <span class="nn">mh</span>
<span class="kn">import</span> <span class="nn">BMSS.models.setup_sg</span>         <span class="k">as</span> <span class="nn">ssg</span>
<span class="kn">import</span> <span class="nn">BMSS.models.ia_results</span>       <span class="k">as</span> <span class="nn">ir</span>
<span class="kn">import</span> <span class="nn">BMSS.strike_goldd_simplified</span> <span class="k">as</span> <span class="nn">sg</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Connected to MBase_models, UBase_models
Connected to MBase_settings, UBase_settings
</pre></div></div>
</div>
<p>After importing the required modules, we read the config files to set up the necessarydata structures. Note: Note that in the first example, the settings were put in a separate file(s). This allowed us to switch between different groups of settings. However, since we only need one group of settings in this example, we can combine that group of settings with the core_model file for brevity.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[system_type]
system_type = LogicGate, Not, Single

[states]
states = p1, p2

[parameters]
parameters = kp1, synp1, synp2, rep, degp

[inputs]
inputs = u1

[equations]
equations =
    dp1 = synp1 *u1                    -degp*p1
    dp2 = synp2 *(kp1+rep*p1)/(kp1+p1) -degp*p2



[LogicGate, Not, Single]

init =
    p1 = [0],
    p2 = [0]

guess =
    kp1   = [5e-5],
    synp1 = [1e-5],
    synp2 = [1e-5],
    rep   = [0.8],
    degp  = [0.012],
    u1    = [0]

priors =
    degp = [0.012, 0.04]

parameter_bounds =
    kp1    = [1e-7, 1e-4],
    synp1  = [1e-7, 1e-4],
    synp2  = [1e-7, 1e-4],
    rep    = [0, 1],
    degp   = [0.001, 0.05],
    u1     = [0, 1]

input_conditions =
    u1 = 3

fixed_parameters =
    [degp, u1]

measured_states =
    [p1, p2]

decomposition =
    [[p1, p2]]

units =
    kp1   = M,
    synp1 = M/min,
    synp2 = M/min,
    rep   = NONE,
    degp  = 1/min,
    u1    = NONE
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Set up core models and sampler arguments</span>
<span class="n">model_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;LogicGate_Not_Single.ini&#39;</span><span class="p">,</span>
               <span class="p">]</span>

<span class="n">user_core_models</span> <span class="o">=</span> <span class="p">[</span><span class="n">mh</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">model_files</span><span class="p">]</span>
<span class="n">user_core_models</span> <span class="o">=</span> <span class="p">{</span><span class="n">core_model</span><span class="p">[</span><span class="s1">&#39;system_type&#39;</span><span class="p">]:</span> <span class="n">core_model</span> <span class="k">for</span> <span class="n">core_model</span> <span class="ow">in</span> <span class="n">user_core_models</span><span class="p">}</span>

<span class="n">sg_args</span><span class="p">,</span> <span class="n">config_data</span><span class="p">,</span> <span class="n">variables</span> <span class="o">=</span> <span class="n">ssg</span><span class="o">.</span><span class="n">get_strike_goldd_args</span><span class="p">(</span><span class="n">model_files</span><span class="p">,</span> <span class="n">user_core_models</span><span class="o">=</span><span class="n">user_core_models</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sg_results</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">analyze_sg_args</span><span class="p">(</span><span class="n">sg_args</span><span class="p">)</span>
<span class="n">outfile</span>   <span class="o">=</span> <span class="s1">&#39;sg_results.yaml&#39;</span>
<span class="n">yaml_dict</span> <span class="o">=</span> <span class="n">ir</span><span class="o">.</span><span class="n">export_sg_results</span><span class="p">(</span><span class="n">sg_results</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">config_data</span><span class="p">,</span> <span class="n">user_core_models</span><span class="o">=</span><span class="n">user_core_models</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
States :  [p1_1, p2_1]
Outputs:  [p1_1, p2_1]
Params :  [kp1_1, synp1_1, synp2_1, rep_1, degp_1]
Inputs :  {u1_1: 3}
ICS    :  {p1_1: 0.0, p2_1: 0.0}
Equations:
-degp_1*p1_1 + synp1_1*u1_1
-degp_1*p2_1 + synp2_1*(kp1_1 + p1_1*rep_1)/(kp1_1 + p1_1)
Building Oi with 3 derivatives and size (8, 7)
Time for adding one Lie derivative: 0.17090320587158203
Time for adding one Lie derivative: 0.25185346603393555
Time for adding one Lie derivative: 0.32781291007995605
Time for building Oi: 0.8884921073913574
Checking rank for matrix with size (8, 7)
Rank 6
Time for Row Reduction: 10.525646686553955
Elim-recalc for matrix with size (8, 7)
Found [synp1_1, synp2_1, degp_1]
Extending Oi
Time for adding one Lie derivative: 0.5756707191467285
Checking rank for matrix with size (10, 7)
Rank 6
Time for Row Reduction: 1.8969168663024902
Elim-recalc for matrix with size (10, 7)
Found []
14.34646224975586
...................................................
Total Time: 14.348460912704468
</pre></div></div>
</div>
<p>The results are returned inside the dictionary dst.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yaml_dict</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;system_type&#39;: &#39;LogicGate, Not, Single&#39;,
 &#39;init&#39;: {&#39;p1&#39;: 0.0, &#39;p2&#39;: 0.0},
 &#39;input&#39;: {&#39;p1&#39;: 1,
  &#39;p2&#39;: 1,
  &#39;kp1&#39;: 0,
  &#39;synp1&#39;: 0,
  &#39;synp2&#39;: 0,
  &#39;rep&#39;: 0,
  &#39;degp&#39;: 0,
  &#39;u1&#39;: 3},
 &#39;output&#39;: {&#39;p1&#39;: 1,
  &#39;p2&#39;: 1,
  &#39;kp1&#39;: 0,
  &#39;synp1&#39;: 1,
  &#39;synp2&#39;: 1,
  &#39;rep&#39;: 0,
  &#39;degp&#39;: 1}}
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="_Example_3nb.html" class="btn btn-neutral float-left" title="3. Making a Model Selection Workflow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Russell Ngo Jie Kai

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>